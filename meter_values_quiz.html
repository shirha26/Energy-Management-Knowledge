<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OCPP 1.6 Meter Values Quiz</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .quiz-info {
            background: rgba(79, 172, 254, 0.1);
            padding: 20px 40px;
            text-align: center;
            border-bottom: 1px solid rgba(79, 172, 254, 0.2);
        }

        .quiz-info p {
            color: #333;
            font-size: 1rem;
        }

        .quiz-content {
            padding: 40px;
        }

        .question {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            border-left: 5px solid #4facfe;
        }

        .question h3 {
            color: #333;
            font-size: 1.3rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .question-number {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1rem;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            background: rgba(79, 172, 254, 0.05);
            border: 2px solid rgba(79, 172, 254, 0.2);
            border-radius: 10px;
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .option:hover {
            background: rgba(79, 172, 254, 0.1);
            border-color: #4facfe;
            transform: translateX(5px);
        }

        .option.selected {
            background: rgba(79, 172, 254, 0.2);
            border-color: #4facfe;
            color: #333;
        }

        .option.correct {
            background: rgba(46, 204, 113, 0.2);
            border-color: #2ecc71;
            color: #27ae60;
        }

        .option.incorrect {
            background: rgba(231, 76, 60, 0.2);
            border-color: #e74c3c;
            color: #c0392b;
        }

        .option input[type="radio"] {
            width: 20px;
            height: 20px;
            accent-color: #4facfe;
        }

        .option label {
            cursor: pointer;
            flex: 1;
            font-size: 1rem;
        }

        .controls {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            margin-bottom: 25px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            align-items: center;
        }

        .btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            margin: 0 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }

        .btn.home {
            background: linear-gradient(135deg, #4ffec9 0%, #00fe4c 100%);
            color: white;
            border: black;
            border-width: 1px;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            text-shadow: #333;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
            text-decoration: none;
            display: inline-block;
        }

        .btn.home:hover{
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 254, 146, 0.4);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 172, 254, 0.4);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }

        .btn.secondary {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
        }

        .results {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            display: none;
        }

        .score {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .score.excellent {
            color: #27ae60;
        }

        .score.good {
            color: #f39c12;
        }

        .score.needs-improvement {
            color: #e74c3c;
        }

        .feedback {
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .explanation {
            background: rgba(79, 172, 254, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
            text-align: left;
            display: none;
        }

        .explanation h4 {
            color: #4facfe;
            margin-bottom: 10px;
        }

        .explanation.show {
            display: block;
        }

        @media (max-width: 768px) {
            .container {
                margin: 8px;
                border-radius: 15px;
            }
            
            .header {
                padding: 25px 15px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }

            .header p {
                font-size: 1rem;
            }

            .quiz-content {
                padding: 15px;
            }

            .question h3 { 
                font-size: 1.1rem;
                line-height: 1.3;
            }
            
            .question {
                padding: 18px;
            }
            
            .controls {
                padding: 12px;
                gap: 8px;
            }
            
            .btn {
                padding: 8px 16px;
                font-size: 0.85rem;
                margin: 2px;
                min-width: 100px;
            }

            .option label {
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5rem;
            }
            
            .header p {
                font-size: 0.9rem;
            }
            
            .quiz-content {
                padding: 12px;
            }
            
            .question {
                padding: 15px;
            }
            
            .question h3 {
                font-size: 1rem;
                line-height: 1.2;
            }
            
            .btn {
                font-size: 0.8rem;
                padding: 6px 12px;
                min-width: 90px;
            }
            
            .option {
                padding: 12px 15px;
            }
            
            .option label {
                font-size: 0.85rem;
                line-height: 1.3;
            }
        }

        @media (max-width: 360px) {
            .header h1 {
                font-size: 1.3rem;
            }
            
            .quiz-content {
                padding: 10px;
            }
            
            .question {
                padding: 12px;
            }
            
            .question h3 {
                font-size: 0.9rem;
            }
            
            .btn {
                font-size: 0.75rem;
                padding: 5px 10px;
                min-width: 80px;
            }
            
            .option label {
                font-size: 0.8rem;
            }
            
            .option {
                padding: 10px 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🧠 OCPP 1.6 Knowledge Quiz</h1>
            <p>Test your understanding of Meter Values</p>
        </div>

        <div class="quiz-info">
            <p>📊 <strong>Randomized Quiz:</strong> 5 questions selected from a bank of questions | Each attempt will have different questions</p>
            <div style="margin-top: 15px;">
                <a href="ocpp16_meter_value.html" class="btn" style="background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%); text-decoration: none; display: inline-block;">
                    📖 Back to Study Guide
                </a>
                <a href="index.html" class="btn home">🏠 Back to Manu</a>

            </div>
        </div>

        <div class="quiz-content">
            <div id="questionsContainer">
                <!-- Questions will be dynamically inserted here -->
            </div>

            <div class="controls">
                <button class="btn" onclick="submitQuiz()" id="submitBtn">📝 Submit Quiz</button>
                <button class="btn secondary" onclick="generateNewQuiz()" id="newQuizBtn">🎲 New Random Quiz</button>
                <button class="btn secondary" onclick="resetQuiz()" id="resetBtn">🔄 Reset Current Quiz</button>
            </div>



            <div style="text-align: center; margin-top: 20px;">
                <a href="ocpp16_meter_value.html" class="btn" style="background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%); text-decoration: none; display: inline-block;">📖 Back to Guide</a>
                <a href="index.html" class="btn home">🏠 Back to Manu</a>


            </div>
        

            <div class="results" id="results">
                <div class="score" id="scoreDisplay"></div>
                <div class="feedback" id="feedbackText"></div>
                <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-top: 20px;">
                    <button class="btn" onclick="showExplanations()">💡 View Explanations</button>
                    <a href="ocpp16_meter_value.html" class="btn" style="background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%); text-decoration: none; display: inline-block;">📖 Review Study Guide</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Bank of 15 questions
        const questionBank = [
            {
                id: 1,
                question: "What is the best analogy for understanding SoC (State of Charge)?",
                options: [
                    { text: "Like measuring water pressure in pipes", correct: false },
                    { text: "Like the battery indicator on your phone showing percentage", correct: true },
                    { text: "Like measuring the speed of water flowing through a hose", correct: false },
                    { text: "Like measuring temperature with a thermometer", correct: false }
                ],
                explanation: "SoC (State of Charge) shows how 'full' the car's battery is as a percentage, exactly like your phone's battery indicator. 0% = empty, 100% = full, 50% = half full."
            },
            {
                id: 2,
                question: "When do EV chargers send meter values to the management system?",
                options: [
                    { text: "Only when charging starts and stops", correct: false },
                    { text: "Only once per day for billing purposes", correct: false },
                    { text: "During charging (can be every few seconds), at start/stop, and on request", correct: true },
                    { text: "Only when there's a problem with the charger", correct: false }
                ],
                explanation: "Chargers send meter values frequently during charging (can be seconds to minutes apart), when sessions start/end, and whenever the management system requests current readings."
            },
            {
                id: 3,
                question: "What does 'Power.Active.Import' measure, and what's the best analogy to understand it?",
                options: [
                    { text: "Total energy consumed, like a car's odometer showing total miles", correct: false },
                    { text: "How fast energy is being delivered, like how quickly a swimming pool is filling", correct: true },
                    { text: "Electrical pressure, like water pressure in pipes", correct: false },
                    { text: "How hot the equipment is, like a fever thermometer", correct: false }
                ],
                explanation: "Power measures the speed of energy transfer right now. It combines both current (flow) and voltage (pressure) to show how quickly energy is being delivered to the car, like measuring how fast a pool fills."
            },
            {
                id: 4,
                question: "According to the JSON example, what does this meter value data tell us: Energy=15.75 kWh, SoC=85%, Current=32.5A, Power=7.5kW?",
                options: [
                    { text: "The car has just started charging and the battery is nearly empty", correct: false },
                    { text: "The car has consumed 15.75 kWh, battery is 85% full, currently drawing 32.5A at 7.5kW power", correct: true },
                    { text: "There is a problem with the charger because the numbers don't match", correct: false },
                    { text: "The charging session is complete and the car is disconnected", correct: false }
                ],
                explanation: "This shows an active charging session where 15.75 kWh has been delivered so far, the battery is 85% charged, and it's currently drawing 32.5 amps of current at 7.5 kilowatts of power."
            },
            {
                id: 5,
                question: "Why are meter values important for EV charging operations? (Select the MOST comprehensive answer)",
                options: [
                    { text: "Only for calculating customer bills", correct: false },
                    { text: "Only for monitoring safety parameters like temperature and voltage", correct: false },
                    { text: "For billing, safety monitoring, energy management, diagnostics, and legal compliance", correct: true },
                    { text: "Only for technical diagnostics when equipment fails", correct: false }
                ],
                explanation: "Meter values serve multiple critical purposes: calculating accurate customer bills, ensuring safety by monitoring voltage/current/temperature, managing energy consumption across chargers, detecting equipment problems early, and meeting legal requirements for energy measurement."
            },
            {
                id: 6,
                question: "What does 'Current.Import' measure and what's the best everyday analogy?",
                options: [
                    { text: "How much total energy has been used, like reading a gas meter", correct: false },
                    { text: "How fast electricity is flowing, like gallons per minute through a garden hose", correct: true },
                    { text: "How much pressure is pushing the electricity, like water pressure", correct: false },
                    { text: "How hot the charging cable is getting during use", correct: false }
                ],
                explanation: "Current measures the flow rate of electricity going into the car's battery right now. It's like measuring how many gallons per minute are flowing through your garden hose - higher current means electricity is flowing faster."
            },
            {
                id: 7,
                question: "What does 'Voltage' represent in electrical terms?",
                options: [
                    { text: "The total amount of electricity consumed", correct: false },
                    { text: "The electrical 'pressure' that pushes electricity through wires", correct: true },
                    { text: "The speed at which energy is being transferred", correct: false },
                    { text: "The percentage of battery charge remaining", correct: false }
                ],
                explanation: "Voltage is like electrical pressure - it's the force that pushes electricity through wires. Higher voltage pushes electricity more effectively, just like higher water pressure pushes water through pipes more effectively."
            },
            {
                id: 8,
                question: "What does 'Energy.Active.Import.Register' track?",
                options: [
                    { text: "The current power being delivered right now", correct: false },
                    { text: "The total cumulative energy delivered since charging started", correct: true },
                    { text: "The voltage level of the electrical connection", correct: false },
                    { text: "The temperature of the charging equipment", correct: false }
                ],
                explanation: "Energy.Active.Import.Register is like a car's odometer - it keeps a running total of all the electrical energy that has been delivered to the car's battery since charging began."
            },
            {
                id: 9,
                question: "Why do chargers monitor temperature as part of meter values?",
                options: [
                    { text: "To adjust billing rates based on weather conditions", correct: false },
                    { text: "To ensure equipment doesn't overheat and operates safely", correct: true },
                    { text: "To measure how much energy the car is consuming", correct: false },
                    { text: "To determine the car's battery charge level", correct: false }
                ],
                explanation: "Temperature monitoring ensures safety by checking that charging equipment (cables, connectors, electronics) doesn't get dangerously hot during operation, similar to monitoring if your car engine is overheating."
            },
            {
                id: 10,
                question: "In the JSON example, what does the 'timestamp' field represent?",
                options: [
                    { text: "When the charging session will end", correct: false },
                    { text: "When the specific measurement was taken", correct: true },
                    { text: "How long the car has been charging", correct: false },
                    { text: "When the car was manufactured", correct: false }
                ],
                explanation: "The timestamp shows exactly when each measurement was recorded, allowing the management system to track changes over the duration of the charging session."
            },
            {
                id: 11,
                question: "What is a 'measurand' in OCPP terminology?",
                options: [
                    { text: "A type of electric vehicle that can be charged", correct: false },
                    { text: "A specific type of measurement being taken (like energy, voltage, current)", correct: true },
                    { text: "A charging station location identifier", correct: false },
                    { text: "A billing rate for electricity consumption", correct: false }
                ],
                explanation: "A measurand is simply the specific thing being measured - whether it's energy consumption, voltage levels, current flow, temperature, battery charge level, or power delivery rate."
            },
            {
                id: 12,
                question: "What does 'kWh' measure and why is it important for billing?",
                options: [
                    { text: "Power delivery rate, used to calculate charging speed", correct: false },
                    { text: "Total energy consumed, used to calculate what customers should pay", correct: true },
                    { text: "Electrical pressure, used to ensure safe operation", correct: false },
                    { text: "Battery charge percentage, used to estimate charging time", correct: false }
                ],
                explanation: "kWh (kilowatt-hours) measures the total amount of electrical energy consumed, just like what appears on your home electricity bill. This is the key measurement for calculating how much to charge customers."
            },
            {
                id: 13,
                question: "How does the 'location' field in meter values help operators?",
                options: [
                    { text: "It shows which city the charger is located in", correct: false },
                    { text: "It identifies where on the charging equipment the measurement was taken", correct: true },
                    { text: "It tells you which parking space the car is in", correct: false },
                    { text: "It shows the GPS coordinates of the charging station", correct: false }
                ],
                explanation: "The location field specifies where the measurement was taken (outlet, cable, EV, etc.), helping operators understand if problems are in specific components of the charging system."
            },
            {
                id: 14,
                question: "What can operators learn from comparing Power vs Energy measurands?",
                options: [
                    { text: "Power shows current charging speed, Energy shows total consumption", correct: true },
                    { text: "Power shows battery percentage, Energy shows voltage levels", correct: false },
                    { text: "Power shows temperature, Energy shows current flow", correct: false },
                    { text: "They measure the same thing with different units", correct: false }
                ],
                explanation: "Power (kW) tells you how fast energy is being delivered right now (like speed), while Energy (kWh) tells you the total amount delivered over time (like distance traveled). Both are crucial for different operational insights."
            },
            {
                id: 15,
                question: "Why might an operator want meter values sent every few seconds instead of every few minutes?",
                options: [
                    { text: "To increase billing revenue from customers", correct: false },
                    { text: "To detect problems quickly and monitor real-time charging performance", correct: true },
                    { text: "To reduce the amount of data transmitted to servers", correct: false },
                    { text: "To comply with government regulations on data collection", correct: false }
                ],
                explanation: "More frequent meter values allow operators to detect equipment problems, safety issues, or charging anomalies much faster, enabling quicker response to protect equipment and ensure customer satisfaction."
            }
        ];

        let currentQuestions = [];
        let selectedAnswers = {};
        let submitted = false;

        function generateRandomQuestions() {
            // Shuffle the question bank and take first 5
            const shuffled = [...questionBank].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, 5);
        }

        function renderQuestions() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';

            currentQuestions.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.id = `q${question.id}`;

                const optionsHtml = question.options.map((option, optIndex) => `
                    <div class="option" onclick="selectOption(this, 'q${question.id}', ${option.correct})">
                        <input type="radio" name="q${question.id}" value="${optIndex}" id="q${question.id}${String.fromCharCode(97 + optIndex)}">
                        <label for="q${question.id}${String.fromCharCode(97 + optIndex)}">${option.text}</label>
                    </div>
                `).join('');

                questionDiv.innerHTML = `
                    <h3>
                        <span class="question-number">${index + 1}</span>
                        ${question.question}
                    </h3>
                    <div class="options">
                        ${optionsHtml}
                    </div>
                    <div class="explanation">
                        <h4>✅ Correct Answer: ${question.options.find(opt => opt.correct).text}</h4>
                        <p>${question.explanation}</p>
                    </div>
                `;

                container.appendChild(questionDiv);
            });
        }

        function selectOption(element, questionId, isCorrect) {
            if (submitted) return;

            // Remove selection from other options in this question
            const question = document.getElementById(questionId);
            const options = question.querySelectorAll('.option');
            options.forEach(opt => opt.classList.remove('selected'));

            // Add selection to clicked option
            element.classList.add('selected');
            element.querySelector('input').checked = true;

            // Store the answer
            selectedAnswers[questionId] = isCorrect;
        }

        function submitQuiz() {
            if (Object.keys(selectedAnswers).length < 5) {
                alert('Please answer all questions before submitting!');
                return;
            }

            submitted = true;
            
            // Calculate score
            const correctAnswers = Object.values(selectedAnswers).filter(answer => answer === true).length;
            const totalQuestions = 5;
            const percentage = Math.round((correctAnswers / totalQuestions) * 100);

            // Show correct/incorrect styling
            currentQuestions.forEach(question => {
                const questionDiv = document.getElementById(`q${question.id}`);
                const options = questionDiv.querySelectorAll('.option');
                
                options.forEach((option, optIndex) => {
                    const isSelected = option.classList.contains('selected');
                    const isCorrect = question.options[optIndex].correct;
                    
                    if (isSelected) {
                        if (selectedAnswers[`q${question.id}`]) {
                            option.classList.add('correct');
                        } else {
                            option.classList.add('incorrect');
                        }
                    }
                    
                    // Highlight correct answer if wrong answer was selected
                    if (isCorrect && !isSelected && selectedAnswers[`q${question.id}`] === false) {
                        option.classList.add('correct');
                    }
                });
            });

            // Display results
            const resultsDiv = document.getElementById('results');
            const scoreDisplay = document.getElementById('scoreDisplay');
            const feedbackText = document.getElementById('feedbackText');

            scoreDisplay.textContent = `${correctAnswers}/${totalQuestions} (${percentage}%)`;
            
            if (percentage >= 80) {            
                scoreDisplay.className = 'score excellent';
                feedbackText.textContent = '🎉 Excellent! You have a solid understanding of OCPP meter values!';
                // Mark meter values module as completed
                try {
                    if (window.parent && typeof window.parent.markModuleCompleted === 'function') {
                        window.parent.markModuleCompleted('meterValues');
                    } else if (typeof markModuleCompleted === 'function') {
                        markModuleCompleted('meterValues');
                    } else if (window.markModuleCompleted) {
                        window.markModuleCompleted('meterValues');
                    }
                } catch (error) {
                    console.log('Could not mark module completed:', error);
                }
            } else if (percentage >= 60) {
                scoreDisplay.className = 'score good';
                feedbackText.textContent = '👍 Good job! You understand the basics. Review the explanations to master the details.';
            } else {
                scoreDisplay.className = 'score needs-improvement';
                feedbackText.textContent = '📚 Keep studying! Review the guide and try again to improve your understanding.';
            }

            resultsDiv.style.display = 'block';
            document.getElementById('submitBtn').disabled = true;
        }

        function showExplanations() {
            const explanations = document.querySelectorAll('.explanation');
            explanations.forEach(exp => exp.classList.add('show'));
        }

        function resetQuiz() {
            submitted = false;
            selectedAnswers = {};
            
            // Reset all styling
            const options = document.querySelectorAll('.option');
            options.forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
                opt.querySelector('input').checked = false;
            });

            // Hide results and explanations
            document.getElementById('results').style.display = 'none';
            const explanations = document.querySelectorAll('.explanation');
            explanations.forEach(exp => exp.classList.remove('show'));

            // Re-enable submit button
            document.getElementById('submitBtn').disabled = false;
        }

        function generateNewQuiz() {
            // Reset everything
            resetQuiz();
            
            // Generate new random questions
            currentQuestions = generateRandomQuestions();
            
            // Render new questions
            renderQuestions();
        }

        // Initialize quiz on page load
        document.addEventListener('DOMContentLoaded', () => {
            currentQuestions = generateRandomQuestions();
            renderQuestions();
        });
    
    </script>
</body>
</html>
